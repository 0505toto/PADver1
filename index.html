<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>経理部ポータルサイト</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome (アイコン) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts (Inter & Noto Sans JP) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- SortableJS (ドラッグ&ドロップ用ライブラリ) -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

    <style>
        /* ==============================================
           CSS - デザインとアニメーション
           ============================================== */
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #030712;
            color: #d1d5db;
            overflow: hidden;
        }
        .background-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; background: #030712;
        }
        .aurora { position: absolute; border-radius: 50%; filter: blur(100px); opacity: 0.3; }
        .aurora-1 { width: 50vw; height: 50vw; background: #4f46e5; top: -25vw; left: -25vw; animation: move-aurora-1 25s infinite alternate ease-in-out; }
        .aurora-2 { width: 40vw; height: 40vw; background: #7c3aed; bottom: -20vw; right: -20vw; animation: move-aurora-2 20s infinite alternate ease-in-out; }
        .aurora-3 { width: 30vw; height: 30vw; background: #10b981; bottom: 10vw; left: 20vw; animation: move-aurora-3 30s infinite alternate ease-in-out; }
        @keyframes move-aurora-1 { from { transform: translate(0, 0) rotate(0deg); } to { transform: translate(10vw, 20vh) rotate(30deg); } }
        @keyframes move-aurora-2 { from { transform: translate(0, 0) rotate(0deg); } to { transform: translate(-15vw, -15vh) rotate(-40deg); } }
        @keyframes move-aurora-3 { from { transform: translate(0, 0) rotate(0deg); } to { transform: translate(5vw, -10vh) rotate(20deg); } }
        
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: rgba(31, 41, 55, 0.5); }
        ::-webkit-scrollbar-thumb { background: rgba(75, 85, 99, 0.7); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(107, 114, 128, 0.9); }
        
        .card {
            background: rgba(17, 24, 39, 0.6); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(55, 65, 81, 0.7); transition: all 0.3s ease; transform: translateY(0);
            animation: card-fade-in 0.5s ease-out forwards; opacity: 0;
            cursor: grab;
        }
        .card:hover {
            transform: translateY(-6px) scale(1.02); background: rgba(31, 41, 55, 0.7);
            border-color: rgba(79, 70, 229, 0.8);
            box-shadow: 0 10px 25px -3px rgba(79, 70, 229, 0.2), 0 4px 10px -2px rgba(79, 70, 229, 0.1);
        }
        @keyframes card-fade-in { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .grid > .card { animation-delay: calc(var(--i, 0) * 50ms); }
        
        .section-title { border-left: 4px solid #6366f1; padding-left: 1rem; text-shadow: 0 0 10px rgba(99, 102, 241, 0.3); }
        
        .sortable-ghost { opacity: 0.4; background: #4f46e5; border-style: dashed; }
        .sortable-chosen { cursor: grabbing; }
        
        .favorite-item .delete-btn { opacity: 0; transform: scale(0.8); transition: all 0.2s ease-in-out; }
        .favorite-item:hover .delete-btn { opacity: 1; transform: scale(1); }
        
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center; z-index: 100;
            opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-container {
            background: rgba(17, 24, 39, 0.8); backdrop-filter: blur(15px); border: 1px solid rgba(55, 65, 81, 0.7);
            padding: 2rem; border-radius: 1rem; width: 90%; max-width: 500px;
            transform: scale(0.95); transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-container { transform: scale(1); }
        .modal-input {
            background-color: rgba(31, 41, 55, 0.8) !important; border: 1px solid #4b5563 !important;
            color: white !important; outline: none;
        }
        .modal-input:focus { border-color: #6366f1 !important; box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.5) !important; }
    </style>
</head>
<body>
    <!-- 背景 -->
    <div class="background-container">
        <div class="aurora aurora-1"></div>
        <div class="aurora aurora-2"></div>
        <div class="aurora aurora-3"></div>
    </div>
    
    <!-- メインレイアウト -->
    <div class="relative z-10 flex flex-col lg:flex-row min-h-screen">

        <!-- ===== メインコンテンツ (8割) ===== -->
        <main class="w-full lg:w-4/5 p-4 sm:p-6 lg:p-8 overflow-y-auto">
            <header class="mb-8">
                <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
                    <div>
                        <h1 class="text-4xl font-bold text-white tracking-tight">経理ポータル</h1>
                        <p class="text-gray-400">最終更新日: 2025年7月2日 Ver.1.0</p>
                    </div>
                    <a href="https://ini5a.kinjirou-asp.jp/PLNT1701/KinjirouWeb/kinjirou/kwtop/kwtop.aspx?type=20005" target="_blank" class="card bg-indigo-600/80 hover:bg-indigo-600 text-white font-bold py-3 px-5 rounded-lg flex items-center gap-2 transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-indigo-500/30 cursor-pointer">
                        <i class="fas fa-user-clock"></i><span>勤怠 (勤次郎)</span>
                    </a>
                </div>
                <div class="card grid grid-cols-1 md:grid-cols-2 gap-6 p-4 rounded-xl cursor-default">
                    <div id="weather-widget" class="flex items-center gap-4 p-2">
                         <i class="fas fa-spinner fa-spin text-cyan-400 text-4xl"></i><div><p class="font-bold text-lg text-white">大阪の天気</p><p class="text-gray-400">天気情報を取得中...</p></div>
                    </div>
                    <form action="https://www.google.com/search" method="get" target="_blank" class="flex items-center w-full">
                        <input type="text" name="q" placeholder="Googleで検索..." class="w-full bg-gray-800 border border-gray-700 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-white transition">
                        <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-r-lg transition-colors"><i class="fas fa-search"></i></button>
                    </form>
                </div>
            </header>

            <div class="space-y-12">
                <section>
                    <h2 class="section-title text-2xl font-semibold mb-5 text-white"><i class="fas fa-calendar-alt mr-2 text-indigo-400"></i>Schedule</h2>
                    <div id="schedule-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <a href="https://planteckk.sharepoint.com/sites/msteams_9d310a/SiteAssets/SitePages/Home/%E3%80%90%E7%B5%8C%E7%90%86%E9%83%A8%E3%80%91%E5%B9%B4%E9%96%93%E6%A5%AD%E5%8B%99.xlsx?web=1" target="_blank" class="card p-6 flex items-center gap-4" style="--i:1;"><i class="fas fa-file-excel text-green-400 text-3xl fa-fw"></i><div><h3 class="font-bold text-lg text-white">年間業務</h3><p class="text-gray-400">年間スケジュールを確認</p></div></a>
                        <a href="https://outlook.office.com/calendar/view/month" target="_blank" class="card p-6 flex items-center gap-4" style="--i:2;"><i class="fas fa-calendar-day text-blue-400 text-3xl fa-fw"></i><div><h3 class="font-bold text-lg text-white">日常業務</h3><p class="text-gray-400">Outlookカレンダー</p></div></a>
                    </div>
                </section>

                <section>
                    <h2 class="section-title text-2xl font-semibold mb-5 text-white"><i class="fas fa-calculator mr-2 text-indigo-400"></i>経理部門 業務リンク</h2>
                    <div id="accounting-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                        <a href="https://business.getmoneytree.com/landing" target="_blank" class="card p-4 flex items-center gap-3" style="--i:3;"><i class="fas fa-tree fa-fw text-green-500"></i>Moneytree</a>
                        <a href="https://plantec-kk.app.bill-one.com/recipient/accounting/invoices" target="_blank" class="card p-4 flex items-center gap-3" style="--i:4;"><i class="fas fa-file-invoice-dollar fa-fw text-yellow-500"></i>Billone</a>
                        <a href="https://app.makeleaps.com/home/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:5;"><i class="fas fa-file-signature fa-fw text-blue-500"></i>MakeLeaps</a>
                        <a href="https://hz6n32v7pq52.cybozu.com/k/#/portal" target="_blank" class="card p-4 flex items-center gap-3" style="--i:6;"><i class="fas fa-cubes fa-fw text-red-500"></i>Kintone</a>
                        <a href="https://rsphoto.rakurakuseisan.jp/yCiwuzXNzTa/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:7;"><i class="fas fa-yen-sign fa-fw text-green-400"></i>楽楽精算</a>
                        <a href="https://hz6n32v7pq52.cybozu.com/k/167/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:8;"><i class="fas fa-address-book fa-fw text-purple-500"></i>経理住所録</a>
                        <a href="https://0505toto.github.io/NetBankingportal/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:9;"><i class="fas fa-landmark fa-fw text-gray-400"></i>SPCNetBanking</a>
                        <a href="https://menu.a-saas.jp/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:10;"><i class="fas fa-cloud fa-fw text-sky-400"></i>A-saas</a>
                    </div>
                </section>
                
                <section>
                    <h2 class="section-title text-2xl font-semibold mb-5 text-white"><i class="fas fa-building mr-2 text-indigo-400"></i>社内共通リンク</h2>
                    <div id="company-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                        <a href="https://hz6n32v7pq52.cybozu.com/g/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:11;"><i class="fas fa-users fa-fw text-yellow-400"></i>Garoon</a>
                        <a href="http://pweb/plantec_main/top.php" target="_blank" class="card p-4 flex items-center gap-3" style="--i:12;"><i class="fas fa-sitemap fa-fw text-gray-500"></i>旧ポータル</a>
                        <a href="https://plantec.media.ourly.jp/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:13;"><i class="fas fa-newspaper fa-fw text-blue-400"></i>PlantecNews</a>
                        <a href="https://www.fukuri.jp/fkr/apps/log/AASC10111.cfm?action=login" target="_blank" class="card p-4 flex items-center gap-3" style="--i:14;"><i class="fas fa-gift fa-fw text-pink-400"></i>RELO CLUB</a>
                    </div>
                </section>

                <section>
                    <h2 class="section-title text-2xl font-semibold mb-5 text-white"><i class="fas fa-brain mr-2 text-indigo-400"></i>AI & 便利ツール</h2>
                    <div id="tools-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                        <a href="https://chatgpt.com/" target="_blank" class="card p-4 flex items-center gap-3" style="--i:15;"><i class="fas fa-robot fa-fw text-teal-400"></i>ChatGPT</a>
                        <a href="https://gemini.google.com/app?hl=ja" target="_blank" class="card p-4 flex items-center gap-3" style="--i:16;"><i class="fas fa-star-of-life fa-fw text-purple-400"></i>Gemini</a>
                        <a href="#" class="card p-4 flex items-center gap-3 opacity-50 cursor-not-allowed" style="--i:17;"><i class="fas fa-address-card fa-fw text-gray-500"></i>社員内線一覧表</a>
                        <a href="#" class="card p-4 flex items-center gap-3 opacity-50 cursor-not-allowed" style="--i:18;"><i class="fas fa-tools fa-fw text-gray-500"></i>便利サイト</a>
                    </div>
                </section>
            </div>
        </main>

        <!-- ===== サイドバー (2割) ===== -->
        <aside class="w-full lg:w-1/5 bg-black/30 p-6 flex-shrink-0 border-l border-gray-800/50 overflow-y-auto">
            <div class="sticky top-6">
                <h2 class="text-xl font-bold mb-5 text-white"><i class="fas fa-bolt mr-2 text-yellow-400"></i>Quick Access</h2>
                <div class="space-y-3 mb-8">
                    <h3 class="font-semibold text-gray-400 text-sm tracking-wider uppercase">銀行サイト</h3>
                    <a href="https://corporate.bk.mufg.jp/frontend/auth" target="_blank" class="card p-4 flex items-center gap-3"><i class="fas fa-university text-red-500 text-xl fa-fw"></i><span class="text-white">Main銀行 (MUFG)</span></a>
                    <a href="https://www.b-direct.resonabank.co.jp/0010c/oauth/auth?response_type=code&client_id=OPRS0010&redirect_uri=https://wb.resona-gr.co.jp/webservice/WSOI0102E100M.do&state=OIDCRelateState&nonce=a2dc98c7afe54bba9c52241753b99eba&approvaldiv=2&balance_inquiry_use=0&account_activity_use=0&account_activity_zengin_use=0&transfer_payment_use=0&transfer_payment_zengin_use=0&transfer_request_use=0&comprehensive_transfer_request_use=0&salary_bonus_transfer_request_use=0&account_transfer_1_request_use=0&account_transfer_2_request_use=0&account_transfer_3_request_use=0&account_transfer_4_request_use=0&account_transfer_5_request_use=0&bulk_account_verification_request_use=0&transfer_inquiry_use=0&comprehensive_transfer_inquiry_use=0&salary_bonus_transfer_inquiry_use=0&account_transfer_1_inquiry_use=0&account_transfer_2_inquiry_use=0&account_transfer_3_inquiry_use=0&account_transfer_4_inquiry_use=0&account_transfer_5_inquiry_use=0&bulk_account_verification_inquiry_use=0&transfer_approval_use=0&comprehensive_transfer_approval_use=0&salary_bonus_transfer_approval_use=0&account_transfer_1_approval_use=0&account_transfer_2_approval_use=0&account_transfer_3_approval_use=0&account_transfer_4_approval_use=0&account_transfer_5_approval_use=0&bulk_account_verification_approval_use=0&account_transfer_1_result_use=0&account_transfer_2_result_use=0&account_transfer_3_result_use=0&account_transfer_4_result_use=0&account_transfer_5_result_use=0&account_transfer_1_fee_use=0&account_transfer_2_fee_use=0&account_transfer_3_fee_use=0&account_transfer_4_fee_use=0&account_transfer_5_fee_use=0&openid_use=1&erm_claims_inquiry_use=0&erm_payment_use=0&erm_financings_use=0" target="_blank" class="card p-4 flex items-center gap-3"><i class="fas fa-university text-green-500 text-xl fa-fw"></i><span class="text-white">Sub銀行 (りそな)</span></a>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-400 text-sm tracking-wider uppercase mb-3">お気に入り</h3>
                    <div id="favorites-list" class="space-y-2"></div>
                    <button id="add-favorite-btn" class="w-full mt-4 bg-indigo-600/80 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-all duration-200 hover:gap-3 hover:scale-105">
                        <i class="fas fa-plus-circle"></i><span>お気に入り追加</span>
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <!-- お気に入り追加モーダル -->
    <div id="favorite-modal" class="modal-overlay">
        <div class="modal-container">
            <h2 class="text-xl font-bold text-white mb-4">お気に入りに追加</h2>
            <form id="favorite-form">
                <div class="mb-4">
                    <label for="fav-name" class="block text-gray-300 mb-2">名前</label>
                    <input type="text" id="fav-name" class="modal-input w-full p-2 rounded-md" required>
                </div>
                <div class="mb-6">
                    <label for="fav-url" class="block text-gray-300 mb-2">URL</label>
                    <input type="url" id="fav-url" value="https://" class="modal-input w-full p-2 rounded-md" required>
                </div>
                <div class="flex justify-end gap-4">
                    <button type="button" id="modal-cancel-btn" class="py-2 px-4 bg-gray-600 hover:bg-gray-500 rounded-md transition-colors">キャンセル</button>
                    <button type="submit" class="py-2 px-4 bg-indigo-600 hover:bg-indigo-500 rounded-md transition-colors text-white">保存</button>
                </div>
            </form>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // ===== DOM要素の取得 =====
        const weatherWidget = document.getElementById('weather-widget');
        const favoritesList = document.getElementById('favorites-list');
        const addFavoriteBtn = document.getElementById('add-favorite-btn');
        const modal = document.getElementById('favorite-modal');
        const modalForm = document.getElementById('favorite-form');
        const cancelBtn = document.getElementById('modal-cancel-btn');
        const favNameInput = document.getElementById('fav-name');
        const favUrlInput = document.getElementById('fav-url');
        const storageKey = 'accountingPortalFavorites_v3'; // キーを更新して古いデータをリセット

        // ===== 天気予報機能 =====
        const getWeatherInfo = (code) => {
            const map = {0:"快晴",1:"晴れ",2:"一部曇り",3:"曇り",45:"霧",48:"霧氷",51:"霧雨",53:"霧雨",55:"霧雨",61:"小雨",62:"雨",63:"大雨",80:"にわか雨",81:"にわか雨",82:"激しいにわか雨",95:"雷雨"};
            const iconMap = {0:"fa-sun",1:"fa-sun",2:"fa-cloud-sun",3:"fa-cloud",45:"fa-smog",48:"fa-snowflake",51:"fa-cloud-rain",53:"fa-cloud-rain",55:"fa-cloud-rain",61:"fa-cloud-showers-heavy",62:"fa-cloud-showers-heavy",63:"fa-cloud-showers-heavy",80:"fa-cloud-bolt",81:"fa-cloud-bolt",82:"fa-cloud-bolt",95:"fa-bolt"};
            return { text: map[code] || "不明", icon: iconMap[code] || "fa-question-circle" };
        };
        const fetchWeather = async () => {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=34.69&longitude=135.50&current=temperature_2m,weather_code&daily=temperature_2m_max,temperature_2m_min&timezone=Asia%2FTokyo`;
            try {
                const res = await fetch(url);
                if (!res.ok) throw new Error('Network response was not ok');
                const data = await res.json();
                const info = getWeatherInfo(data.current.weather_code);
                weatherWidget.innerHTML = `<i class="fas ${info.icon} text-cyan-400 text-4xl fa-fw"></i><div><p class="font-bold text-lg text-white">${info.text} ${Math.round(data.current.temperature_2m)}°C</p><p class="text-gray-400">最高: ${Math.round(data.daily.temperature_2m_max[0])}°C / 最低: ${Math.round(data.daily.temperature_2m_min[0])}°C</p></div>`;
            } catch (error) {
                console.error("Weather fetch error:", error);
                weatherWidget.innerHTML = `<i class="fas fa-exclamation-triangle text-red-400 text-4xl fa-fw"></i><div><p class="font-bold text-lg text-white">エラー</p><p class="text-gray-400">情報を取得できませんでした</p></div>`;
            }
        };

        // ===== お気に入り機能 =====
        let favorites = JSON.parse(localStorage.getItem(storageKey)) || [];
        const renderFavorites = () => {
            favoritesList.innerHTML = '';
            if (favorites.length === 0) {
                favoritesList.innerHTML = `<div class="border-2 border-dashed border-gray-700 p-4 rounded-lg text-center text-gray-500 cursor-default"><p>よく使うリンクを<br>追加できます</p></div>`;
                return;
            }
            favorites.forEach((fav, index) => {
                const el = document.createElement('a');
                el.href = fav.url;
                el.target = '_blank';
                el.className = 'favorite-item card p-3 rounded-lg flex items-center justify-between gap-3';
                el.dataset.id = index;
                el.innerHTML = `<div class="flex items-center gap-3 overflow-hidden"><i class="fas fa-star text-yellow-400 fa-fw"></i><span class="text-white truncate">${fav.name}</span></div><button data-index="${index}" class="delete-btn text-gray-500 hover:text-red-400 transition-colors p-2 -mr-2"><i class="fas fa-trash-alt"></i></button>`;
                favoritesList.appendChild(el);
            });
        };
        const saveFavorites = () => localStorage.setItem(storageKey, JSON.stringify(favorites));
        const showModal = () => { modal.classList.add('active'); favNameInput.focus(); };
        const hideModal = () => modal.classList.remove('active');

        addFavoriteBtn.addEventListener('click', showModal);
        cancelBtn.addEventListener('click', hideModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) hideModal(); });
        
        modalForm.addEventListener('submit', (e) => {
            e.preventDefault();
            favorites.push({ name: favNameInput.value, url: favUrlInput.value });
            saveFavorites();
            renderFavorites();
            modalForm.reset();
            favUrlInput.value = 'https://';
            hideModal();
        });

        favoritesList.addEventListener('click', (e) => {
            const deleteButton = e.target.closest('.delete-btn');
            if (deleteButton) {
                e.preventDefault();
                const index = parseInt(deleteButton.dataset.index, 10);
                if (confirm(`「${favorites[index].name}」を削除しますか？`)) {
                    favorites.splice(index, 1);
                    saveFavorites();
                    renderFavorites();
                }
            }
        });

        // ===== ドラッグ＆ドロップ機能 =====
        const initSortable = () => {
            const sortableGrids = ['#schedule-grid', '#accounting-grid', '#company-grid', '#tools-grid'];
            sortableGrids.forEach(id => {
                const el = document.querySelector(id);
                if (el) new Sortable(el, { animation: 150, ghostClass: 'sortable-ghost', forceFallback: true });
            });
            new Sortable(favoritesList, {
                animation: 150,
                ghostClass: 'sortable-ghost',
                forceFallback: true,
                onEnd: (evt) => {
                    const item = favorites.splice(evt.oldIndex, 1)[0];
                    favorites.splice(evt.newIndex, 0, item);
                    saveFavorites();
                    renderFavorites();
                },
            });
        };

        // ===== 初期化処理 =====
        const initialize = () => {
            fetchWeather();
            renderFavorites();
            initSortable();
            document.querySelectorAll('.grid > .card').forEach((card, index) => {
                card.style.setProperty('--i', index);
            });
        };
        initialize();
    });
    </script>
</body>
</html>
